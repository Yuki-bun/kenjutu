# CLAUDE.md

This file provides guidance to Claude Code (claude.ai/code) when working with code in this repository.

## Project Overview

PR Manager is a Tauri 2 desktop application for managing GitHub pull requests locally. It combines a React/TypeScript frontend with a Rust backend.

## Development Commands

```bash
# Build for production (takes a lot of time. Don't run this command for type checking)
pnpm tauri build

# Type checking
pnpm check

# Generate ts bindings for tauri commands
pnpm gen

# Cargo commands are avaiable from the root of this repoisitory
cargo build ....
```

## Architecture

### Frontend (`/src`)

- **React 19** with **TanStack Router** (file-based routing in `/src/routes`)
- **TanStack Query** for data fetching
- **shadcn/ui** components in `/src/components/ui`
- **Octokit** for GitHub API calls (runs in frontend, not backend)
- Path alias: `@/` maps to `./src/`

### Backend (`/src-tauri`)

- **Rust with Tauri 2** framework
- **git2** for local git operations (diff generation)
- **SQLite** via rusqlite for persistence
- **two-face/Syntect** for syntax highlighting
- **tauri-specta** auto-generates TypeScript bindings from Rust commands

### Key Directories

- `/src/routes` - Page components (index, repos.$owner.$repo, pulls.$owner.$repo.$number)
- `/src/hooks` - Custom hooks including `useRpcQuery.ts` for Tauri IPC
- `/src/context/GithubContext.tsx` - Auth state and Octokit instance
- `/src-tauri/src/commands` - Tauri IPC command handlers
- `/src-tauri/src/services` - Business logic (auth, diff, git, highlight, review)
- `/src-tauri/migrations` - SQLite schema

### Data Flow

1. GitHub API calls happen in the frontend via Octokit
2. Local git operations (diffs, commits) go through Tauri commands to the Rust backend
3. Review tracking persists to SQLite via backend commands

### Database Schema

Two tables: `repository` (maps GitHub repo ID to local path) and `reviewed_files` (tracks reviewed files per PR with composite key: repo_id, pr_number, change_id, file_path, patch_id)

### IPC Pattern

Rust commands in `/src-tauri/src/commands/` return `Result<T, CommandError>`. TypeScript bindings are auto-generated by tauri-specta. Use hooks in `/src/hooks/useRpcQuery.ts` to call backend.

## Code Style

- No semicolons
- Newtype wrappers for IDs: `PatchId`, `ChangeId`, `GhRepoId` in `/src-tauri/src/models/git.rs`
